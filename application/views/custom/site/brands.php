<section class="main_row"><div class="section_inner"><h4 class="page_title"><?if($page_info['show_title']>0):?><?= $page_info['title']; ?><?endif;?></h4> <?$brands=$this->diff_func_mapper->brands();?><div id="brand_nav">	<div id="brand_selector" class="brand_selector">		<div class="letter_slide_prev"></div>		<div class="letter_slide_next"></div>		<div class="letter_slider_wrapper">			<ul id="brands_slider" class="brands_slider">                <?foreach(range('A','Z') as $i):?>                    <?$flaq=0;?>                    <?foreach($brands as $key => $br):?>                        <?if($i == $br['name']{0}):?>                                           <?$flaq=1;?>                        <?endif;?>                    <?endforeach;?>                    <?if($flaq == 1):?>                        <li class="brand_letter_control"><a class="brand_letter_link" href="#"><?echo $i;?></a></li>                    <?endif;?>                <?endforeach;?>							</ul>		</div>	</div></div><div class="fixed_spacer"></div><?foreach(range('A','Z') as $i):?>    <?$flaq=0;?>    <?foreach($brands as $key => $br):?>        <?if($i == $br['name']{0}):?>               <?$flaq=1;?>        <?endif;?>    <?endforeach;?>    <?if($flaq == 1):?>            <div class="brand_row mod_letter"><?echo $i;?></div>            <ul class="brands_list">            <?foreach($brands as $keys => $br2):?>                <?if($i == $br2['name']{0}):?>                <li class="brand_l_item"><a class="brand_link" href="/catalog?brand=<?=$br2['id']?>"><?=$br2['name'];?></a></li>                <?endif;?>            <?endforeach;?>            </ul>    <?endif;?><?endforeach;?></div></section><script>	$(document).ready(function ($) {		function initNavFix() {			var form = $('#brand_nav'),					formTop = form.offset().top - form.css('margin-top').replace('px', '') * 1 - form.css('border-top-width').replace('px', '') * 1;			$(document).scroll(function () {				if ($(document).scrollTop() > formTop) form.addClass('nav_fixed');				else form.removeClass('nav_fixed');			});		}		$('#brands_slider').bxSlider({			slideSelector: ('.brand_letter_control'),			//			minSlides: 1,			//			maxSlides: 1,			moveSlides: 1,			nextSelector: $('.letter_slide_next'),			prevSelector: $('.letter_slide_prev'),			prevText: '',			nextText: '',			infiniteLoop: false,			responsive: false,			pager: false		});		var letter_bookmarks = $('.brand_row.mod_letter'),			brandControls = $('.brand_letter_control'),			letterTimout = 1000,		    newPos = getCurrentScrollPos(),			curPos = 0;		brandControls.on('click', function () {			var firedEl = $(this);			if (!firedEl.hasClass('current_letter')) {				$.scrollTo(letter_bookmarks.eq(firedEl.index()).offset().top - 50, letterTimout);			}			return false;		});		function getCurrentScrollPos() {			for (var i = 0; i < letter_bookmarks.length; i++) {				var obj = $(letter_bookmarks[i]);				if (obj.offset().top > $(document).scrollTop()) {					return i;				}			}		}		$(document).scroll(function () {			newPos = getCurrentScrollPos();			if (newPos !== curPos) {				brandControls.eq(newPos).addClass('current_letter').siblings().removeClass('current_letter');				curPos = newPos;			}		});		initNavFix();	});</script>